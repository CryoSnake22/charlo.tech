+++
title = "A Quick dive into Black Scholes"
date = "2025-10-16"
+++

**Intuition and Thinking**
Imagine pricing a stock using a basic $\mu$ like so

$$
dS_{t}=\mu S_{t}dt+\sigma S_{t}dW_{t}^{\mathbb{P}}
$$

Where $\mathbb{P}$ is the typical probability measure. Then what we're trying to do here is estimate the price of the stock to get a payoff then price an option using that. But what if

- Bob thinks the price is going to rise 20% and wants $\mu=0.2$
- Alice thinks the price is going to fall 10% and wants $\mu=-0.1$.

How do we price the option ? The truth is we cannot price the option in this biased manner we have to assume the most risk neutral basic expected thing, otherwise we introduce arbitrage where taking bets in a certain direction consistently yields more profit, aka an _arbitrage opportunity_. So we have to change our pricing and assume an idealized world where every stock grows at the risk neutral rate. We therefore end up with

$$
\begin{align*}
dS_{t}&=(r-q)S_{t}dt+\sigma S_{t}dW_{t}^{\mathbb{Q}} \\\\
dS_{t}&=rS_{t}dt+\sigma S_{t}dW_{t}^{\mathbb{Q}} \\\\
\end{align*}
$$

Where $r-q$ is the average expected return per year minus the dividends given by the company (which eat away at stock value). Which we simplify to simply $rS_{t}dt$ since we assumed $q=0$. Then we can finally write the option payoff as

$$
P=e^{-rT}\mathbb{E}^{\mathbb{Q}}[\text{payoff}(S_{t})]
$$

_Payoff for european options:_ For a european option, the payoff is simply

$$
\text{payoff} = \max(S_{t}-K,0)
$$

Where $K$ is the strike price of the option. Now let $\Pi_{t}$ be a [[Portfolio|hedged portfolio]] of the form

$$
\Pi_{t}=V(S_{t},t)-\Delta_{t}S_{t}
$$

Wher $V(S_{t},t)$ is a shorthand for $V(S_{t},t;K,r,\sigma,T)$. and $\Delta_{t}$ is the quantity of stock held at time $t$. We know that $V(S_{t},t)$ depends on the random process $S_{t}$ with $dS_{t}=rS_{t}dt+\sigma S_{t}dW_{t}$, we can therefore apply [[Ito's Lemma (Stochastic Processes)|ito's lemma]]. So

$$
\begin{align*}
dV&=V_{t}dt+V_{S}dS_{t}+\frac{1}{2} V_{S S}(dS_{t})^{2} \\\\
&=V_{t}dt+V_{S}(rS_{t}dt+\sigma S_{t}dW_{t})+\frac{1}{2}V_{S S}(rS_{t}dt+\sigma S_{t}dW_{t})^{2} \\\\
&=V_{t}dt+V_{S}rS_{t}dt+V_{S}\sigma S_{t}dW_{t}+\frac{1}{2}V_{S S}((rS_{t}dt)^{2}+2r\sigma  S_{t}^{2}(dW_{t}dt)+(\sigma S_{t}(dW_{t}))^{2}
\end{align*}
$$

From the properties $dt^{2}=0$, $dW_{t}dt=0$ and $dW_{t}^{2}=dt$ so most of the terms disapear

$$
\begin{align*}
dV&=V_{t}dt+rV_{S}S_{t}dt+\sigma V_{S} S_{t}dW_{t}+\frac{1}{2}V_{S S}(0+0+\sigma^{2}S_{t}^{2}dt) \\\\
&=V_{t}dt+rV_{S}S_{t}dt+\sigma V_{S}S_{t}dW_{t}+\frac{1}{2}V_{S S}\sigma^{2}S_{t}^{2}dt\\\\
dV&=(V_{t}+rV_{S}S_{t}+\frac{1}{2}\sigma^{2}V_{S S}S_{t}^{2})dt+\sigma V_{S} S_{t}dW_{t}\\\\
\end{align*}
$$

The final expansion is

$$
\boxed{ dV=(V_{t}+rV_{S}S_{t}+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S})dt+\sigma S_{t}V_{S} dW_{t}}
$$

_I couldve just skipped to the final form with the basic ito derivation but where's the fun in that_. Great so now we have $dV$ and $dS$ so we can find $d\Pi_{t}$

$$
\begin{align*}
d\Pi_{t}&=dV-\Delta_{t}dS_{t} \\\\
&= ((V_{t}+rV_{S}S_{t}+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S})dt+\sigma S_{t}V_{S} dW_{t})-\Delta_{t}(rS_{t}dt+\sigma S_{t}dW_{t})
\end{align*}
$$

We want to cancel our the randomness, so here we have two terms $\sigma S_{t}V_{S}dW_{t}$ and $-\Delta_{t}(\sigma S_{t}dW_{t})$ If we want to ensure deterministic behaviour, we need to cancel out the $dW_{t}$'s so we set $\Delta_{t}=V_{S}$ which leads to $\sigma S_{t}V_{S}dW_{t}-\sigma S_{t}V_{S}dW_{t}=0$, therefore

$$
\begin{align*}
d\Pi_{t}&=(V_{t}+rV_{S}S_{t}+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S})dt+\sigma S_{t}V_{S}dW_{t} -rS_{t}V_{S}dt-\sigma S_{t}V_{S}dW_{t} \\\\
&=(V_{t}+rV_{S}S_{t}+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S})dt-rS_{t}V_{S}dt+(\sigma S_{t}V_{S}dW_{t} -\sigma S_{t}V_{S}dW_{t}) \\\\
&=(V_{t}+rV_{S}S_{t}+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S})dt-rS_{t}V_{S}dt+(0)\\\\
&=V_{t}dt+rV_{S}S_{t}dt+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S}dt-rS_{t}V_{S}dt\\\\
&=V_{t}dt+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S}dt+rV_{S}S_{t}dt-rS_{t}V_{S}dt\\\\
&=V_{t}dt+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S}dt
\end{align*}
$$

And since we have $d\Pi_{t}=r\Pi_{t}dt$ since it's a riskless portfolio, we can set

$$
\begin{align*}
V_{t}dt+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S}dt&=r \Pi_{t}dt  \\\\
V_{t}dt+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S}dt-r \Pi_{t}dt&=0
\end{align*}
$$

Since we set $\Delta_{t}=V_{S}$ we can say $\Pi_{t}=V-V_{S}S_{t}$ therefore

$$
\begin{align*}
V_{t}dt+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S} dt-r(V-V_{S}S_{t})dt&=0 \\\\
V_{t}dt+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S} dt-rVdt-rV_{S}S_{t}dt&=0 \\\\
(V_{t}+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S} -rV-rV_{S}S_{t})dt&=0 \\\\
\end{align*}
$$

Which implies for a non-zero $dt$ that

$$
V_{t}+\frac{1}{2}\sigma^{2}S_{t}^{2}V_{S S}+rS_{t}V_{S}-rV=0
$$

_How this fits and why we're doing this_
Essentially the question we're asking is: at time $t<T$ what would be the fair price of an option such that its expected payoff aligns with the risk free rate. Or even more bluntly, what's a fair price for the option right now so that if I hedged it correctly it would essentially be the same as depositing into a risk free bank account or a riskless government bond at rate $r$.

I am going to skip the derivation of the closed form since I'm limited on time, but I will come back to it at some point.

The final closed form with $q=0$
_European Call Option_

$$
C(S,t)=S\Phi(d_{1})-Ke^{(-r(T-t))}\Phi(d_{2})
$$

$$
d_{1}=\frac{\ln\left( \frac{S}{K} \right)+\left( r+\frac{1}{2}\sigma^{2} \right)(T-t)}{\sigma \sqrt{ T-t }}
$$

$$
d_{2}=d_{1}-\sigma \sqrt{ T-t }
$$

If instead we were pricing a*European Put Option* the closed form would be this:

$$
P(S,t)=Ke^{(-r(T-t))}\Phi(d_{2})-S\Phi(d_{1})
$$

This comes from _put-call parity_. If $q\neq 0$ then we simply replace $r$ with $r-1$ in $d_{1}$ and other adjustments. In practice we typically keep the dividend term $q$ to make the model generalize better which leads to the following closed form.

_European Call Option with non-zero q_

$$
C(S,t)=Se^{(-q(T-t))}\Phi(d_{1})-Ke^{-r(T-t)}\Phi(d_{2})
$$

_European Put Option with non-zero q_

$$
C(S,t)=Ke^{-r(T-t)}\Phi(d_{2})-Se^{(-q(T-t))}\Phi(d_{1})
$$

With the $d_{1},d_{2}$ terms as

$$
d_{1}=\frac{\ln\left( \frac{S}{K} \right)+\left( r-q+\frac{1}{2}\sigma^{2} \right)(T-t)}{\sigma \sqrt{ T-t }}
$$

$$
d_{2}=d_{1}-\sigma \sqrt{ T-t }
$$
